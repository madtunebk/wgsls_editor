{
  "version": "1.0",
  "encoding": "base64",
  "fragment": "Ly8gM0QgcmF5bWFyY2hpbmcgZGVtbyB3aXRoIGF1ZGlvIHJlYWN0aXZpdHkKCi8vIDNEIHJvdGF0aW9uIG1hdHJpY2VzCmZuIHJvdGF0ZV95KGE6IGYzMikgLT4gbWF0M3gzPGYzMj4gewogICAgbGV0IHMgPSBzaW4oYSk7CiAgICBsZXQgYyA9IGNvcyhhKTsKICAgIHJldHVybiBtYXQzeDM8ZjMyPigKICAgICAgICBjLCAwLjAsIHMsCiAgICAgICAgMC4wLCAxLjAsIDAuMCwKICAgICAgICAtcywgMC4wLCBjCiAgICApOwp9CgpmbiByb3RhdGVfeChhOiBmMzIpIC0+IG1hdDN4MzxmMzI+IHsKICAgIGxldCBzID0gc2luKGEpOwogICAgbGV0IGMgPSBjb3MoYSk7CiAgICByZXR1cm4gbWF0M3gzPGYzMj4oCiAgICAgICAgMS4wLCAwLjAsIDAuMCwKICAgICAgICAwLjAsIGMsIC1zLAogICAgICAgIDAuMCwgcywgYwogICAgKTsKfQoKLy8gU0RGIGZvciBhIGJveApmbiBzZF9ib3gocDogdmVjMzxmMzI+LCBiOiB2ZWMzPGYzMj4pIC0+IGYzMiB7CiAgICBsZXQgcSA9IGFicyhwKSAtIGI7CiAgICByZXR1cm4gbGVuZ3RoKG1heChxLCB2ZWMzPGYzMj4oMC4wKSkpICsgbWluKG1heChxLngsIG1heChxLnksIHEueikpLCAwLjApOwp9CgovLyBTY2VuZSBTREYKZm4gbWFwKHA6IHZlYzM8ZjMyPiwgdDogZjMyLCBiYXNzOiBmMzIpIC0+IGYzMiB7CiAgICB2YXIgcF92YXIgPSBwOwogICAgCiAgICAvLyBSb3RhdGUgdGhlIHNjZW5lCiAgICBwX3ZhciA9IHJvdGF0ZV95KHQgKiAwLjUpICogcF92YXI7CiAgICBwX3ZhciA9IHJvdGF0ZV94KHQgKiAwLjMpICogcF92YXI7CiAgICAKICAgIC8vIEF1ZGlvIHJlYWN0aXZlIGJveCBzaXplCiAgICBsZXQgYm94X3NpemUgPSB2ZWMzPGYzMj4oMC41ICsgYmFzcyAqIDAuMyk7CiAgICBsZXQgZDEgPSBzZF9ib3gocF92YXIsIGJveF9zaXplKTsKICAgIAogICAgLy8gQWRkIGEgcmVwZWF0aW5nIGdyaWQgb2YgYm94ZXMKICAgIGxldCBncmlkX3AgPSBwX3ZhciAtIHZlYzM8ZjMyPigKICAgICAgICByb3VuZChwX3Zhci54IC8gMi4wKSAqIDIuMCwKICAgICAgICByb3VuZChwX3Zhci55IC8gMi4wKSAqIDIuMCwKICAgICAgICByb3VuZChwX3Zhci56IC8gMi4wKSAqIDIuMAogICAgKTsKICAgIGxldCBkMiA9IHNkX2JveChncmlkX3AsIHZlYzM8ZjMyPigwLjIpKTsKICAgIAogICAgcmV0dXJuIG1pbihkMSwgZDIpOwp9CgovLyBDYWxjdWxhdGUgbm9ybWFsCmZuIGNhbGNfbm9ybWFsKHA6IHZlYzM8ZjMyPiwgdDogZjMyLCBiYXNzOiBmMzIpIC0+IHZlYzM8ZjMyPiB7CiAgICBsZXQgZSA9IHZlYzI8ZjMyPigwLjAwMSwgMC4wKTsKICAgIHJldHVybiBub3JtYWxpemUodmVjMzxmMzI+KAogICAgICAgIG1hcChwICsgZS54eXksIHQsIGJhc3MpIC0gbWFwKHAgLSBlLnh5eSwgdCwgYmFzcyksCiAgICAgICAgbWFwKHAgKyBlLnl4eSwgdCwgYmFzcykgLSBtYXAocCAtIGUueXh5LCB0LCBiYXNzKSwKICAgICAgICBtYXAocCArIGUueXl4LCB0LCBiYXNzKSAtIG1hcChwIC0gZS55eXgsIHQsIGJhc3MpCiAgICApKTsKfQoKQGZyYWdtZW50CmZuIGZzX21haW4oaW46IFZTT3V0KSAtPiBAbG9jYXRpb24oMCkgdmVjNDxmMzI+IHsKICAgIHZhciB1diA9IChpbi51diAqIDIuMCAtIDEuMCkgKiB2ZWMyPGYzMj4odW5pZm9ybXMucmVzb2x1dGlvbi54IC8gdW5pZm9ybXMucmVzb2x1dGlvbi55LCAxLjApOwogICAgCiAgICBsZXQgdCA9IHVuaWZvcm1zLnRpbWU7CiAgICBsZXQgYmFzcyA9IHVuaWZvcm1zLmF1ZGlvX2Jhc3M7CiAgICBsZXQgbWlkID0gdW5pZm9ybXMuYXVkaW9fbWlkOwogICAgbGV0IGhpZ2ggPSB1bmlmb3Jtcy5hdWRpb19oaWdoOwogICAgCiAgICAvLyBDYW1lcmEgc2V0dXAKICAgIGxldCBjYW1lcmFfcG9zID0gdmVjMzxmMzI+KDAuMCwgMC4wLCAtMy4wIC0gYmFzcyk7CiAgICBsZXQgcmF5X2RpciA9IG5vcm1hbGl6ZSh2ZWMzPGYzMj4odXYsIDEuMCkpOwogICAgCiAgICAvLyBSYXltYXJjaAogICAgdmFyIHJheV9wb3MgPSBjYW1lcmFfcG9zOwogICAgdmFyIHRvdGFsX2Rpc3QgPSAwLjA7CiAgICB2YXIgaGl0ID0gZmFsc2U7CiAgICAKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgNjQ7IGkrKykgewogICAgICAgIGxldCBkaXN0ID0gbWFwKHJheV9wb3MsIHQsIGJhc3MpOwogICAgICAgIGlmIGRpc3QgPCAwLjAwMSB7CiAgICAgICAgICAgIGhpdCA9IHRydWU7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgICByYXlfcG9zICs9IHJheV9kaXIgKiBkaXN0OwogICAgICAgIHRvdGFsX2Rpc3QgKz0gZGlzdDsKICAgICAgICBpZiB0b3RhbF9kaXN0ID4gMjAuMCB7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgIH0KICAgIAogICAgdmFyIGNvbCA9IHZlYzM8ZjMyPigwLjApOwogICAgCiAgICBpZiBoaXQgewogICAgICAgIGxldCBub3JtYWwgPSBjYWxjX25vcm1hbChyYXlfcG9zLCB0LCBiYXNzKTsKICAgICAgICBsZXQgbGlnaHRfZGlyID0gbm9ybWFsaXplKHZlYzM8ZjMyPigxLjAsIDEuMCwgLTEuMCkpOwogICAgICAgIGxldCBkaWZmdXNlID0gbWF4KGRvdChub3JtYWwsIGxpZ2h0X2RpciksIDAuMCk7CiAgICAgICAgCiAgICAgICAgLy8gQXVkaW8gcmVhY3RpdmUgY29sb3JzCiAgICAgICAgY29sID0gdmVjMzxmMzI+KAogICAgICAgICAgICAwLjUgKyAwLjUgKiBzaW4odG90YWxfZGlzdCArIHQgKyBiYXNzICogMy4xNCksCiAgICAgICAgICAgIDAuNSArIDAuNSAqIHNpbih0b3RhbF9kaXN0ICsgdCAqIDEuMyArIG1pZCAqIDMuMTQpLAogICAgICAgICAgICAwLjUgKyAwLjUgKiBzaW4odG90YWxfZGlzdCArIHQgKiAxLjcgKyBoaWdoICogMy4xNCkKICAgICAgICApICogZGlmZnVzZTsKICAgICAgICAKICAgICAgICAvLyBBZGQgc29tZSBhbWJpZW50CiAgICAgICAgY29sICs9IHZlYzM8ZjMyPigwLjEsIDAuMSwgMC4xNSk7CiAgICB9IGVsc2UgewogICAgICAgIC8vIEJhY2tncm91bmQgZ3JhZGllbnQKICAgICAgICBjb2wgPSB2ZWMzPGYzMj4oMC4wLCAwLjAsIDAuMSkgKiAoMS4wIC0gbGVuZ3RoKHV2KSAqIDAuNSk7CiAgICB9CiAgICAKICAgIHJldHVybiB2ZWM0PGYzMj4oY29sLCAxLjApOwp9Cg=="
}
